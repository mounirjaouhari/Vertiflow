{
  "annotations": {
    "list": [
      {
        "builtIn": 1,
        "datasource": {
          "type": "grafana",
          "uid": "-- Grafana --"
        },
        "enable": true,
        "hide": true,
        "iconColor": "rgba(0, 211, 255, 1)",
        "name": "Annotations & Alerts",
        "type": "dashboard"
      }
    ]
  },
  "description": "Tableau de bord complet des mod√®les d'Intelligence Artificielle VertiFlow. Visualise en temps r√©el les pr√©dictions de rendement (Oracle A9), les estimations de r√©colte bas√©es sur le mod√®le scientifique GDD+Gompertz (Harvest A9b), la classification qualit√© (Classifier A10) et l'optimisation des recettes agronomiques (Cortex A11).",
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 1,
  "id": 25,
  "links": [],
  "panels": [
    {
      "description": "Vue d'ensemble compl√®te du syst√®me de Machine Learning VertiFlow pour l'agriculture verticale intelligente",
      "fieldConfig": {
        "defaults": {},
        "overrides": []
      },
      "gridPos": {
        "h": 5,
        "w": 24,
        "x": 0,
        "y": 0
      },
      "id": 1,
      "options": {
        "code": {
          "language": "plaintext",
          "showLineNumbers": false,
          "showMiniMap": false
        },
        "content": "## üå± Intelligence Artificielle pour l'Agriculture Verticale\n\nCe tableau de bord pr√©sente les **4 mod√®les ML** actifs de la plateforme VertiFlow :\n\n| Mod√®le | Algorithme | Fonction | R√©f√©rences Scientifiques |\n|--------|-----------|----------|-------------------------|\n| **A9 - Oracle** | RandomForest Regressor | Pr√©diction du rendement (kg/m¬≤) | Breiman (2001) |\n| **A9b - Harvest** | GDD + Gompertz | Pr√©diction date de r√©colte | McMaster & Wilhelm (1997), Zwietering (1990) |\n| **A10 - Classifier** | Gradient Boosting | Classification qualit√© (Premium/Standard/Rejet) | Friedman (2001) |\n| **A11 - Cortex** | Scipy L-BFGS-B | Optimisation des recettes agronomiques | Byrd et al. (1995) |\n\n**Param√®tres Basilic (A9b):** T_base=10¬∞C | GDD_r√©colte=550 | VPD_optimal=0.8-1.2 kPa | DLI_optimal=12-17 mol/m¬≤/jour",
        "mode": "markdown"
      },
      "pluginVersion": "12.3.2",
      "title": "üß† VertiFlow ML Engine - Syst√®me d'Intelligence Agronomique",
      "type": "text"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 5
      },
      "id": 2,
      "panels": [],
      "title": "üìä Vue Globale - Activit√© des 4 Mod√®les ML (24h)",
      "type": "row"
    },
    {
      "datasource": {
        "type": "grafana-clickhouse-datasource",
        "uid": "aeb1b4ee-1f88-42c3-a35a-f594cac90e00"
      },
      "description": "Nombre de pr√©dictions de rendement. Le mod√®le RandomForest analyse temp√©rature, humidit√©, DLI, EC et pH pour estimer le rendement en kg/m¬≤. Performance: R¬≤ > 0.87",
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "green",
            "mode": "fixed"
          },
          "displayName": "Pr√©dictions Rendement",
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 6,
        "x": 0,
        "y": 6
      },
      "id": 3,
      "options": {
        "colorMode": "background",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "12.3.2",
      "targets": [
        {
          "format": 1,
          "rawSql": "SELECT count() FROM vertiflow.basil_ultimate_realtime WHERE timestamp >= now() - INTERVAL 24 HOUR AND predicted_yield_kg_m2 > 0",
          "refId": "A"
        }
      ],
      "title": "üîÆ Oracle A9",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "grafana-clickhouse-datasource",
        "uid": "aeb1b4ee-1f88-42c3-a35a-f594cac90e00"
      },
      "description": "Pr√©dictions de date de r√©colte bas√©es sur le mod√®le GDD (Growing Degree Days) + Gompertz. Calcule l'accumulation thermique et estime les jours restants. R√©f√©rences: McMaster & Wilhelm (1997)",
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "orange",
            "mode": "fixed"
          },
          "displayName": "Pr√©dictions R√©colte",
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "orange",
                "value": 0
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 6,
        "x": 6,
        "y": 6
      },
      "id": 4,
      "options": {
        "colorMode": "background",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "12.3.2",
      "targets": [
        {
          "format": 1,
          "rawSql": "SELECT count() FROM vertiflow.harvest_predictions WHERE timestamp >= now() - INTERVAL 24 HOUR",
          "refId": "A"
        }
      ],
      "title": "üå°Ô∏è Harvest A9b",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "grafana-clickhouse-datasource",
        "uid": "aeb1b4ee-1f88-42c3-a35a-f594cac90e00"
      },
      "description": "Classifications de qualit√©. Le mod√®le Gradient Boosting √©value chaque lot selon le score de sant√©, VPD, DLI et EC pour attribuer un grade: Premium (>85%), Standard (60-85%), Rejet (<60%). Pr√©cision: >92%",
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "blue",
            "mode": "fixed"
          },
          "displayName": "Classifications",
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "blue",
                "value": 0
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 6,
        "x": 12,
        "y": 6
      },
      "id": 5,
      "options": {
        "colorMode": "background",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "12.3.2",
      "targets": [
        {
          "format": 1,
          "rawSql": "SELECT count() FROM vertiflow.quality_classifications WHERE timestamp >= now() - INTERVAL 24 HOUR",
          "refId": "A"
        }
      ],
      "title": "üéØ Classifier A10",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "grafana-clickhouse-datasource",
        "uid": "aeb1b4ee-1f88-42c3-a35a-f594cac90e00"
      },
      "description": "Optimisations de recettes agronomiques. L'algorithme L-BFGS-B optimise simultan√©ment EC (1.0-2.5), pH (5.5-6.5), temp√©rature (18-28¬∞C) et DLI (12-20) pour maximiser le rendement pr√©dit.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "purple",
            "mode": "fixed"
          },
          "displayName": "Optimisations",
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "purple",
                "value": 0
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 6,
        "x": 18,
        "y": 6
      },
      "id": 6,
      "options": {
        "colorMode": "background",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "12.3.2",
      "targets": [
        {
          "format": 1,
          "rawSql": "SELECT count() FROM vertiflow.ml_predictions WHERE timestamp >= now() - INTERVAL 24 HOUR",
          "refId": "A"
        }
      ],
      "title": "üß¨ Cortex A11",
      "type": "stat"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 10
      },
      "id": 7,
      "panels": [],
      "title": "ü§ñ A9 - ORACLE : Pr√©diction de Rendement (RandomForest)",
      "type": "row"
    },
    {
      "datasource": {
        "type": "grafana-clickhouse-datasource",
        "uid": "aeb1b4ee-1f88-42c3-a35a-f594cac90e00"
      },
      "description": "Moyenne des rendements pr√©dits par le mod√®le Oracle sur les derni√®res 24h. Le mod√®le RandomForest utilise 5 features: temp√©rature, humidit√©, DLI, EC et pH. Objectif: >3.5 kg/m¬≤ pour le basilic.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "thresholds"
          },
          "decimals": 2,
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "red",
                "value": 0
              },
              {
                "color": "yellow",
                "value": 2
              },
              {
                "color": "green",
                "value": 3.5
              }
            ]
          },
          "unit": "kg/m¬≤"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 5,
        "w": 6,
        "x": 0,
        "y": 11
      },
      "id": 8,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "12.3.2",
      "targets": [
        {
          "format": 1,
          "rawSql": "SELECT round(avg(predicted_yield_kg_m2), 2) FROM vertiflow.basil_ultimate_realtime WHERE timestamp >= now() - INTERVAL 24 HOUR AND predicted_yield_kg_m2 > 0",
          "refId": "A"
        }
      ],
      "title": "üåø Rendement Moyen Pr√©dit",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "grafana-clickhouse-datasource",
        "uid": "aeb1b4ee-1f88-42c3-a35a-f594cac90e00"
      },
      "description": "Rendement maximum pr√©dit sur 24h. Indique le potentiel de production dans les meilleures conditions. Seuils: <2 (rouge), 2-3 (jaune), 3-4 (orange), >4 (vert)",
      "fieldConfig": {
        "defaults": {
          "mappings": [],
          "max": 6,
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "red",
                "value": 0
              },
              {
                "color": "orange",
                "value": 2
              },
              {
                "color": "yellow",
                "value": 3
              },
              {
                "color": "green",
                "value": 4
              }
            ]
          },
          "unit": "kg/m¬≤"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 5,
        "w": 6,
        "x": 6,
        "y": 11
      },
      "id": 9,
      "options": {
        "minVizHeight": 75,
        "minVizWidth": 75,
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showThresholdLabels": true,
        "showThresholdMarkers": true,
        "sizing": "auto"
      },
      "pluginVersion": "12.3.2",
      "targets": [
        {
          "format": 1,
          "rawSql": "SELECT round(max(predicted_yield_kg_m2), 2) FROM vertiflow.basil_ultimate_realtime WHERE timestamp >= now() - INTERVAL 24 HOUR",
          "refId": "A"
        }
      ],
      "title": "üìà Rendement Maximum",
      "type": "gauge"
    },
    {
      "datasource": {
        "type": "grafana-clickhouse-datasource",
        "uid": "aeb1b4ee-1f88-42c3-a35a-f594cac90e00"
      },
      "description": "Courbe temporelle des pr√©dictions de rendement par lot de culture. Permet de suivre l'√©volution des performances et d√©tecter les tendances. Agr√©gation horaire sur 7 jours.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 20,
            "gradientMode": "opacity",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "showValues": false,
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "displayName": "Rendement",
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "kg/m¬≤"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 11
      },
      "id": 10,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "max"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "multi",
          "sort": "desc"
        }
      },
      "pluginVersion": "12.3.2",
      "targets": [
        {
          "format": 0,
          "rawSql": "SELECT toStartOfHour(timestamp) as time, avg(predicted_yield_kg_m2) as rendement_predit, batch_id FROM vertiflow.basil_ultimate_realtime WHERE timestamp >= now() - INTERVAL 7 DAY AND predicted_yield_kg_m2 > 0 GROUP BY time, batch_id ORDER BY time",
          "refId": "A"
        }
      ],
      "title": "üìä √âvolution du Rendement Pr√©dit par Zone",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "grafana-clickhouse-datasource",
        "uid": "aeb1b4ee-1f88-42c3-a35a-f594cac90e00"
      },
      "description": "Nombre total de pr√©dictions de rendement g√©n√©r√©es aujourd'hui par le mod√®le Oracle A9.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "blue",
            "mode": "fixed"
          },
          "displayName": "Aujourd'hui",
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": []
      },
      "gridPos": {
        "h": 3,
        "w": 6,
        "x": 0,
        "y": 16
      },
      "id": 11,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "12.3.2",
      "targets": [
        {
          "format": 1,
          "rawSql": "SELECT count() FROM vertiflow.basil_ultimate_realtime WHERE timestamp >= today() AND predicted_yield_kg_m2 > 0",
          "refId": "A"
        }
      ],
      "title": "üìã Total Pr√©dictions",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "grafana-clickhouse-datasource",
        "uid": "aeb1b4ee-1f88-42c3-a35a-f594cac90e00"
      },
      "description": "Stabilit√© des pr√©dictions calcul√©e comme 100 - (√©cart-type / moyenne * 100). Plus la valeur est √©lev√©e, plus les pr√©dictions sont coh√©rentes.",
      "fieldConfig": {
        "defaults": {
          "displayName": "Stabilit√©",
          "mappings": [],
          "max": 100,
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "red",
                "value": 0
              },
              {
                "color": "yellow",
                "value": 70
              },
              {
                "color": "green",
                "value": 85
              }
            ]
          },
          "unit": "percent"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 3,
        "w": 6,
        "x": 6,
        "y": 16
      },
      "id": 12,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "12.3.2",
      "targets": [
        {
          "format": 1,
          "rawSql": "SELECT round(100 - (stddevPop(predicted_yield_kg_m2) / avg(predicted_yield_kg_m2) * 100), 1) FROM vertiflow.basil_ultimate_realtime WHERE timestamp >= now() - INTERVAL 24 HOUR AND predicted_yield_kg_m2 > 0",
          "refId": "A"
        }
      ],
      "title": "üéØ Pr√©cision Mod√®le",
      "type": "stat"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 19
      },
      "id": 13,
      "panels": [],
      "title": "üå°Ô∏è A9b - HARVEST PREDICTOR : Pr√©diction de R√©colte (GDD + Gompertz)",
      "type": "row"
    },
    {
      "description": "Explication du mod√®le Growing Degree Days",
      "fieldConfig": {
        "defaults": {},
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 8,
        "x": 0,
        "y": 20
      },
      "id": 14,
      "options": {
        "code": {
          "language": "plaintext",
          "showLineNumbers": false,
          "showMiniMap": false
        },
        "content": "### Calcul GDD (McMaster & Wilhelm 1997)\n```\nGDD = max(0, T_moyenne - T_base)\n```\n- **T_base** = 10¬∞C (basilic)\n- **GDD r√©colte** = 550 degr√©s-jours\n- **Stades**: SEEDLING (<100) ‚Üí VEGETATIVE (100-400) ‚Üí PRE_HARVEST (400-500) ‚Üí READY (‚â•500)",
        "mode": "markdown"
      },
      "pluginVersion": "12.3.2",
      "title": "üìö Mod√®le Scientifique GDD",
      "type": "text"
    },
    {
      "datasource": {
        "type": "grafana-clickhouse-datasource",
        "uid": "aeb1b4ee-1f88-42c3-a35a-f594cac90e00"
      },
      "description": "Degr√©s-jours de croissance accumul√©s. Le basilic n√©cessite environ 550 GDD pour atteindre la maturit√© de r√©colte. Formule: GDD = Œ£ max(0, T_moy - 10¬∞C)",
      "fieldConfig": {
        "defaults": {
          "mappings": [],
          "max": 550,
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "blue",
                "value": 0
              },
              {
                "color": "green",
                "value": 100
              },
              {
                "color": "yellow",
                "value": 400
              },
              {
                "color": "orange",
                "value": 500
              }
            ]
          },
          "unit": "¬∞C¬∑j"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 4,
        "x": 8,
        "y": 20
      },
      "id": 15,
      "options": {
        "minVizHeight": 75,
        "minVizWidth": 75,
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showThresholdLabels": true,
        "showThresholdMarkers": true,
        "sizing": "auto"
      },
      "pluginVersion": "12.3.2",
      "targets": [
        {
          "format": 1,
          "rawSql": "SELECT round(avg(gdd_accumulated), 0) FROM vertiflow.harvest_predictions WHERE timestamp >= now() - INTERVAL 1 HOUR",
          "refId": "A"
        }
      ],
      "title": "üå°Ô∏è GDD Accumul√©s (Moyenne)",
      "type": "gauge"
    },
    {
      "datasource": {
        "type": "grafana-clickhouse-datasource",
        "uid": "aeb1b4ee-1f88-42c3-a35a-f594cac90e00"
      },
      "description": "Nombre de jours estim√©s avant la r√©colte optimale. Calcul√© en fonction du GDD accumul√© et du taux d'accumulation moyen journalier.",
      "fieldConfig": {
        "defaults": {
          "displayName": "Avant R√©colte",
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              },
              {
                "color": "yellow",
                "value": 7
              },
              {
                "color": "orange",
                "value": 21
              },
              {
                "color": "blue",
                "value": 35
              }
            ]
          },
          "unit": "jours"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 4,
        "x": 12,
        "y": 20
      },
      "id": 16,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "auto",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "12.3.2",
      "targets": [
        {
          "format": 1,
          "rawSql": "SELECT round(avg(days_to_harvest), 0) FROM vertiflow.harvest_predictions WHERE timestamp >= now() - INTERVAL 1 HOUR",
          "refId": "A"
        }
      ],
      "title": "üìÖ Jours Restants",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "grafana-clickhouse-datasource",
        "uid": "aeb1b4ee-1f88-42c3-a35a-f594cac90e00"
      },
      "description": "Biomasse actuelle estim√©e par le mod√®le Gompertz. Courbe de croissance sigmo√Ødale bas√©e sur: B(t) = B_max * exp(-exp(-k*(GDD-GDD_inflexion))). R√©f√©rence: Zwietering et al. (1990)",
      "fieldConfig": {
        "defaults": {
          "displayName": "Par Plant",
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "blue",
                "value": 0
              },
              {
                "color": "green",
                "value": 20
              },
              {
                "color": "yellow",
                "value": 60
              },
              {
                "color": "orange",
                "value": 100
              }
            ]
          },
          "unit": "g"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 4,
        "x": 16,
        "y": 20
      },
      "id": 17,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "12.3.2",
      "targets": [
        {
          "format": 1,
          "rawSql": "SELECT round(avg(biomass_estimated_g), 1) FROM vertiflow.harvest_predictions WHERE timestamp >= now() - INTERVAL 1 HOUR",
          "refId": "A"
        }
      ],
      "title": "üåø Biomasse Estim√©e",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "grafana-clickhouse-datasource",
        "uid": "aeb1b4ee-1f88-42c3-a35a-f594cac90e00"
      },
      "description": "D√©ficit de Pression de Vapeur (kPa). Calcul√© avec l'√©quation de Tetens (1930). Optimal pour basilic: 0.8-1.2 kPa. VPD = e_sat(T) * (1 - HR/100)",
      "fieldConfig": {
        "defaults": {
          "displayName": "VPD",
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "blue",
                "value": 0
              },
              {
                "color": "green",
                "value": 0.8
              },
              {
                "color": "yellow",
                "value": 1.2
              },
              {
                "color": "red",
                "value": 1.5
              }
            ]
          },
          "unit": "kPa"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 4,
        "x": 20,
        "y": 20
      },
      "id": 18,
      "options": {
        "colorMode": "value",
        "graphMode": "none",
        "justifyMode": "auto",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "12.3.2",
      "targets": [
        {
          "format": 1,
          "rawSql": "SELECT round(avg(vpd_kpa), 2) FROM vertiflow.harvest_predictions WHERE timestamp >= now() - INTERVAL 1 HOUR",
          "refId": "A"
        }
      ],
      "title": "üí® VPD Moyen",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "grafana-clickhouse-datasource",
        "uid": "aeb1b4ee-1f88-42c3-a35a-f594cac90e00"
      },
      "description": "Tableau d√©taill√© des pr√©dictions de r√©colte pour chaque zone de culture. Inclut: GDD accumul√©s, jours restants, date pr√©vue, biomasse, stade de croissance, VPD, DLI et facteur de stress.",
      "fieldConfig": {
        "defaults": {
          "custom": {
            "align": "center",
            "cellOptions": {
              "type": "auto"
            },
            "footer": {
              "reducers": []
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "GDD"
            },
            "properties": [
              {
                "id": "unit",
                "value": "¬∞C¬∑j"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Biomasse_g"
            },
            "properties": [
              {
                "id": "unit",
                "value": "g"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Confiance_pct"
            },
            "properties": [
              {
                "id": "unit",
                "value": "percent"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Stade"
            },
            "properties": [
              {
                "id": "custom.cellOptions",
                "value": {
                  "type": "color-text"
                }
              },
              {
                "id": "mappings",
                "value": [
                  {
                    "options": {
                      "PRE_HARVEST": {
                        "color": "yellow",
                        "text": "üåæ Pr√©-r√©colte"
                      },
                      "READY": {
                        "color": "orange",
                        "text": "‚úÇÔ∏è Pr√™t"
                      },
                      "SEEDLING": {
                        "color": "blue",
                        "text": "üå± Semis"
                      },
                      "VEGETATIVE": {
                        "color": "green",
                        "text": "üåø V√©g√©tatif"
                      }
                    },
                    "type": "value"
                  }
                ]
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Stress"
            },
            "properties": [
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "gradient",
                  "type": "color-background"
                }
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "green",
                      "value": 0
                    },
                    {
                      "color": "yellow",
                      "value": 0.7
                    },
                    {
                      "color": "red",
                      "value": 0.5
                    }
                  ]
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 16,
        "x": 0,
        "y": 24
      },
      "id": 19,
      "options": {
        "cellHeight": "sm",
        "showHeader": true
      },
      "pluginVersion": "12.3.2",
      "targets": [
        {
          "format": 1,
          "rawSql": "SELECT zone as Zone, round(gdd_accumulated, 0) as GDD, round(days_to_harvest, 0) as Jours_Restants, predicted_harvest_date as Date_Recolte, round(biomass_estimated_g, 1) as Biomasse_g, growth_stage as Stade, round(vpd_kpa, 2) as VPD_kPa, round(dli_mol, 1) as DLI, round(stress_factor, 2) as Stress, round(confidence * 100, 0) as Confiance_pct FROM vertiflow.harvest_predictions WHERE timestamp >= now() - INTERVAL 2 HOUR ORDER BY timestamp DESC LIMIT 20",
          "refId": "A"
        }
      ],
      "title": "üìä Pr√©dictions de R√©colte par Zone",
      "type": "table"
    },
    {
      "datasource": {
        "type": "grafana-clickhouse-datasource",
        "uid": "aeb1b4ee-1f88-42c3-a35a-f594cac90e00"
      },
      "description": "Suivi de l'accumulation thermique (GDD) et de la croissance de biomasse dans le temps. Permet de visualiser la progression vers la maturit√© de r√©colte.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 15,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "showValues": false,
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byRegexp",
              "options": "GDD.*"
            },
            "properties": [
              {
                "id": "unit",
                "value": "¬∞C¬∑j"
              },
              {
                "id": "custom.axisPlacement",
                "value": "left"
              }
            ]
          },
          {
            "matcher": {
              "id": "byRegexp",
              "options": "Biomasse.*"
            },
            "properties": [
              {
                "id": "unit",
                "value": "g"
              },
              {
                "id": "custom.axisPlacement",
                "value": "right"
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 16,
        "y": 24
      },
      "id": 20,
      "options": {
        "legend": {
          "calcs": [
            "last"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "12.3.2",
      "targets": [
        {
          "format": 0,
          "rawSql": "SELECT toStartOfHour(timestamp) as time, zone, avg(gdd_accumulated) as GDD, avg(biomass_estimated_g) as Biomasse FROM vertiflow.harvest_predictions WHERE timestamp >= now() - INTERVAL 7 DAY GROUP BY time, zone ORDER BY time",
          "refId": "A"
        }
      ],
      "title": "üìà √âvolution GDD et Biomasse",
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 32
      },
      "id": 21,
      "panels": [],
      "title": "üéØ A10 - CLASSIFIER : Classification Qualit√© (Gradient Boosting)",
      "type": "row"
    },
    {
      "datasource": {
        "type": "grafana-clickhouse-datasource",
        "uid": "aeb1b4ee-1f88-42c3-a35a-f594cac90e00"
      },
      "description": "R√©partition des classifications de qualit√© sur 24h. PREMIUM: produit d'excellence (>85% score sant√©), STANDARD: qualit√© acceptable (60-85%), REJECT: non conforme (<60%). Bas√© sur VPD, DLI, EC et temp√©rature.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            }
          },
          "mappings": []
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "PREMIUM"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "green",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "STANDARD"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "yellow",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "REJECT"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "red",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 0,
        "y": 33
      },
      "id": 22,
      "options": {
        "legend": {
          "displayMode": "table",
          "placement": "right",
          "showLegend": true,
          "values": [
            "value",
            "percent"
          ]
        },
        "pieType": "donut",
        "reduceOptions": {
          "calcs": [
            "sum"
          ],
          "fields": "",
          "values": false
        },
        "sort": "desc",
        "tooltip": {
          "hideZeros": false,
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "12.3.2",
      "targets": [
        {
          "format": 1,
          "rawSql": "SELECT toString(predicted_quality_grade) as Grade, count() as Nombre FROM vertiflow.quality_classifications WHERE timestamp >= now() - INTERVAL 24 HOUR GROUP BY predicted_quality_grade ORDER BY Nombre DESC",
          "refId": "A"
        }
      ],
      "title": "ü•á Distribution des Grades de Qualit√©",
      "type": "piechart"
    },
    {
      "datasource": {
        "type": "grafana-clickhouse-datasource",
        "uid": "aeb1b4ee-1f88-42c3-a35a-f594cac90e00"
      },
      "description": "Pourcentage de lots class√©s PREMIUM. Crit√®res: score sant√© >85%, VPD 0.8-1.2 kPa, DLI 12-17 mol/m¬≤/jour, EC 1.2-2.0 mS/cm. Objectif: >70%",
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "green",
            "mode": "fixed"
          },
          "displayName": "Excellence",
          "mappings": [],
          "max": 100,
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              }
            ]
          },
          "unit": "percent"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 4,
        "x": 8,
        "y": 33
      },
      "id": 23,
      "options": {
        "colorMode": "background",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "12.3.2",
      "targets": [
        {
          "format": 1,
          "rawSql": "SELECT round(countIf(predicted_quality_grade = 'PREMIUM') * 100.0 / count(), 1) FROM vertiflow.quality_classifications WHERE timestamp >= now() - INTERVAL 24 HOUR",
          "refId": "A"
        }
      ],
      "title": "üèÜ Premium",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "grafana-clickhouse-datasource",
        "uid": "aeb1b4ee-1f88-42c3-a35a-f594cac90e00"
      },
      "description": "Pourcentage de lots class√©s STANDARD. Qualit√© commerciale acceptable mais perfectible. Score sant√© entre 60% et 85%.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "yellow",
            "mode": "fixed"
          },
          "displayName": "Acceptable",
          "mappings": [],
          "max": 100,
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "yellow",
                "value": 0
              }
            ]
          },
          "unit": "percent"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 4,
        "x": 12,
        "y": 33
      },
      "id": 24,
      "options": {
        "colorMode": "background",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "12.3.2",
      "targets": [
        {
          "format": 1,
          "rawSql": "SELECT round(countIf(predicted_quality_grade = 'STANDARD') * 100.0 / count(), 1) FROM vertiflow.quality_classifications WHERE timestamp >= now() - INTERVAL 24 HOUR",
          "refId": "A"
        }
      ],
      "title": "üì¶ Standard",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "grafana-clickhouse-datasource",
        "uid": "aeb1b4ee-1f88-42c3-a35a-f594cac90e00"
      },
      "description": "Pourcentage de lots class√©s REJECT. Non conforme aux standards de qualit√©. N√©cessite une analyse des causes (stress hydrique, maladies, carences). Objectif: <5%",
      "fieldConfig": {
        "defaults": {
          "color": {
            "fixedColor": "red",
            "mode": "fixed"
          },
          "displayName": "Non Conforme",
          "mappings": [],
          "max": 100,
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "red",
                "value": 0
              }
            ]
          },
          "unit": "percent"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 4,
        "x": 16,
        "y": 33
      },
      "id": 25,
      "options": {
        "colorMode": "background",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "12.3.2",
      "targets": [
        {
          "format": 1,
          "rawSql": "SELECT round(countIf(predicted_quality_grade = 'REJECT') * 100.0 / count(), 1) FROM vertiflow.quality_classifications WHERE timestamp >= now() - INTERVAL 24 HOUR",
          "refId": "A"
        }
      ],
      "title": "‚ö†Ô∏è Rejet",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "grafana-clickhouse-datasource",
        "uid": "aeb1b4ee-1f88-42c3-a35a-f594cac90e00"
      },
      "description": "Niveau de confiance moyen du classificateur. Plus la valeur est √©lev√©e, plus le mod√®le est certain de ses pr√©dictions. Objectif: >80%",
      "fieldConfig": {
        "defaults": {
          "mappings": [],
          "max": 100,
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "red",
                "value": 0
              },
              {
                "color": "yellow",
                "value": 60
              },
              {
                "color": "green",
                "value": 80
              }
            ]
          },
          "unit": "percent"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 4,
        "w": 4,
        "x": 20,
        "y": 33
      },
      "id": 26,
      "options": {
        "minVizHeight": 75,
        "minVizWidth": 75,
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showThresholdLabels": false,
        "showThresholdMarkers": true,
        "sizing": "auto"
      },
      "pluginVersion": "12.3.2",
      "targets": [
        {
          "format": 1,
          "rawSql": "SELECT round(avg(confidence) * 100, 1) FROM vertiflow.quality_classifications WHERE timestamp >= now() - INTERVAL 24 HOUR",
          "refId": "A"
        }
      ],
      "title": "üéØ Confiance Moyenne",
      "type": "gauge"
    },
    {
      "datasource": {
        "type": "grafana-clickhouse-datasource",
        "uid": "aeb1b4ee-1f88-42c3-a35a-f594cac90e00"
      },
      "description": "Tendance des classifications sur 7 jours. Permet d'identifier les p√©riodes probl√©matiques et de corr√©ler avec les conditions environnementales.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 40,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "showValues": false,
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "normal"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Premium"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "green",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Standard"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "yellow",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Rejet"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "red",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 12,
        "y": 37
      },
      "id": 28,
      "options": {
        "legend": {
          "calcs": [
            "sum",
            "mean"
          ],
          "displayMode": "table",
          "placement": "bottom",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "12.3.2",
      "targets": [
        {
          "format": 0,
          "rawSql": "SELECT toStartOfHour(timestamp) as time, countIf(predicted_quality_grade = 'PREMIUM') as Premium, countIf(predicted_quality_grade = 'STANDARD') as Standard, countIf(predicted_quality_grade = 'REJECT') as Rejet FROM vertiflow.quality_classifications WHERE timestamp >= now() - INTERVAL 7 DAY GROUP BY time ORDER BY time",
          "refId": "A"
        }
      ],
      "title": "üìà √âvolution de la Qualit√© dans le Temps",
      "type": "timeseries"
    },
    {
      "datasource": {
        "type": "grafana-clickhouse-datasource",
        "uid": "aeb1b4ee-1f88-42c3-a35a-f594cac90e00"
      },
      "description": "Historique des classifications avec d√©tails des param√®tres d'entr√©e: score sant√©, temp√©rature, VPD, DLI, EC et jours depuis plantation.",
      "fieldConfig": {
        "defaults": {
          "custom": {
            "align": "center",
            "cellOptions": {
              "type": "auto"
            },
            "footer": {
              "reducers": []
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Grade"
            },
            "properties": [
              {
                "id": "mappings",
                "value": [
                  {
                    "options": {
                      "PREMIUM": {
                        "color": "green",
                        "text": "üèÜ PREMIUM"
                      },
                      "REJECT": {
                        "color": "red",
                        "text": "‚ö†Ô∏è REJECT"
                      },
                      "STANDARD": {
                        "color": "yellow",
                        "text": "üì¶ STANDARD"
                      }
                    },
                    "type": "value"
                  }
                ]
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Confiance"
            },
            "properties": [
              {
                "id": "unit",
                "value": "percent"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Score_Sante"
            },
            "properties": [
              {
                "id": "unit",
                "value": "percent"
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 12,
        "x": 0,
        "y": 41
      },
      "id": 27,
      "options": {
        "cellHeight": "sm",
        "showHeader": true
      },
      "pluginVersion": "12.3.2",
      "targets": [
        {
          "format": 1,
          "rawSql": "SELECT timestamp as Heure, batch_id as Lot, toString(predicted_quality_grade) as Grade, round(health_score_input, 1) as Score_Sante, round(air_temp, 1) as Temp_C, round(vpd, 2) as VPD, round(dli, 1) as DLI, round(ec, 2) as EC, days_since_planting as Jours, round(confidence * 100, 0) as Confiance FROM vertiflow.quality_classifications ORDER BY timestamp DESC LIMIT 15",
          "refId": "A"
        }
      ],
      "title": "üìã Derni√®res Classifications de Qualit√©",
      "type": "table"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 50
      },
      "id": 29,
      "panels": [],
      "title": "üß¨ A11 - CORTEX : Optimisation des Recettes (L-BFGS-B)",
      "type": "row"
    },
    {
      "datasource": {
        "type": "grafana-clickhouse-datasource",
        "uid": "aeb1b4ee-1f88-42c3-a35a-f594cac90e00"
      },
      "description": "Score de confiance de d√©tection d'anomalies. Valeur √©lev√©e = anomalie d√©tect√©e avec certitude. Surveiller si >60%.",
      "fieldConfig": {
        "defaults": {
          "mappings": [],
          "max": 100,
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              },
              {
                "color": "yellow",
                "value": 40
              },
              {
                "color": "orange",
                "value": 60
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "percent"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 5,
        "w": 4,
        "x": 12,
        "y": 45
      },
      "id": 32,
      "options": {
        "minVizHeight": 75,
        "minVizWidth": 75,
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showThresholdLabels": true,
        "showThresholdMarkers": true,
        "sizing": "auto"
      },
      "pluginVersion": "12.3.2",
      "targets": [
        {
          "format": 1,
          "rawSql": "SELECT round(avg(anomaly_confidence_score) * 100, 1) FROM vertiflow.basil_ultimate_realtime WHERE timestamp >= now() - INTERVAL 24 HOUR",
          "refId": "A"
        }
      ],
      "title": "üîç Confiance Anomalie",
      "type": "gauge"
    },
    {
      "datasource": {
        "type": "grafana-clickhouse-datasource",
        "uid": "aeb1b4ee-1f88-42c3-a35a-f594cac90e00"
      },
      "description": "Score d'int√©grit√© des modules de culture. Indique l'√©tat de fonctionnement des √©quipements (capteurs, actuateurs). Alerte si <90%.",
      "fieldConfig": {
        "defaults": {
          "mappings": [],
          "max": 100,
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "red",
                "value": 0
              },
              {
                "color": "yellow",
                "value": 80
              },
              {
                "color": "green",
                "value": 90
              }
            ]
          },
          "unit": "percent"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 5,
        "w": 4,
        "x": 16,
        "y": 45
      },
      "id": 33,
      "options": {
        "minVizHeight": 75,
        "minVizWidth": 75,
        "orientation": "auto",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showThresholdLabels": false,
        "showThresholdMarkers": true,
        "sizing": "auto"
      },
      "pluginVersion": "12.3.2",
      "targets": [
        {
          "format": 1,
          "rawSql": "SELECT round(avg(module_integrity_score), 1) FROM vertiflow.basil_ultimate_realtime WHERE timestamp >= now() - INTERVAL 24 HOUR",
          "refId": "A"
        }
      ],
      "title": "üîß Int√©grit√© Module",
      "type": "gauge"
    },
    {
      "datasource": {
        "type": "grafana-clickhouse-datasource",
        "uid": "aeb1b4ee-1f88-42c3-a35a-f594cac90e00"
      },
      "description": "Score d'urgence de maintenance. Valeur √©lev√©e = intervention requise rapidement. Seuils: <30% (OK), 30-60% (Planifier), >60% (Urgent).",
      "fieldConfig": {
        "defaults": {
          "displayName": "Urgence",
          "mappings": [],
          "max": 100,
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              },
              {
                "color": "yellow",
                "value": 30
              },
              {
                "color": "red",
                "value": 60
              }
            ]
          },
          "unit": "percent"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 5,
        "w": 4,
        "x": 20,
        "y": 45
      },
      "id": 34,
      "options": {
        "colorMode": "background",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "12.3.2",
      "targets": [
        {
          "format": 1,
          "rawSql": "SELECT round(avg(maintenance_urgency_score), 1) FROM vertiflow.basil_ultimate_realtime WHERE timestamp >= now() - INTERVAL 24 HOUR",
          "refId": "A"
        }
      ],
      "title": "üö® Urgence Maintenance",
      "type": "stat"
    },
    {
      "description": "Explication de l'optimiseur Cortex A11",
      "fieldConfig": {
        "defaults": {},
        "overrides": []
      },
      "gridPos": {
        "h": 5,
        "w": 8,
        "x": 0,
        "y": 51
      },
      "id": 30,
      "options": {
        "code": {
          "language": "plaintext",
          "showLineNumbers": false,
          "showMiniMap": false
        },
        "content": "### Scipy L-BFGS-B (Byrd et al. 1995)\n\nOptimise simultan√©ment 4 param√®tres sous contraintes:\n\n| Param√®tre | Min | Max | Unit√© |\n|-----------|-----|-----|-------|\n| **EC** | 1.0 | 2.5 | mS/cm |\n| **pH** | 5.5 | 6.5 | - |\n| **Temp√©rature** | 18 | 28 | ¬∞C |\n| **DLI** | 12 | 20 | mol/m¬≤/j |\n\n**Objectif**: Maximiser `predicted_yield`",
        "mode": "markdown"
      },
      "pluginVersion": "12.3.2",
      "title": "‚öôÔ∏è Algorithme d'Optimisation",
      "type": "text"
    },
    {
      "datasource": {
        "type": "grafana-clickhouse-datasource",
        "uid": "aeb1b4ee-1f88-42c3-a35a-f594cac90e00"
      },
      "description": "Score de sant√© global des cultures sur 24h. Indicateur composite bas√© sur les conditions environnementales. Objectif: >85%",
      "fieldConfig": {
        "defaults": {
          "displayName": "Sant√© Globale",
          "mappings": [],
          "max": 100,
          "min": 0,
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "red",
                "value": 0
              },
              {
                "color": "yellow",
                "value": 70
              },
              {
                "color": "green",
                "value": 85
              }
            ]
          },
          "unit": "percent"
        },
        "overrides": []
      },
      "gridPos": {
        "h": 5,
        "w": 4,
        "x": 8,
        "y": 51
      },
      "id": 31,
      "options": {
        "colorMode": "value",
        "graphMode": "area",
        "justifyMode": "auto",
        "orientation": "auto",
        "percentChangeColorMode": "standard",
        "reduceOptions": {
          "calcs": [
            "lastNotNull"
          ],
          "fields": "",
          "values": false
        },
        "showPercentChange": false,
        "textMode": "auto",
        "wideLayout": true
      },
      "pluginVersion": "12.3.2",
      "targets": [
        {
          "format": 1,
          "rawSql": "SELECT round(avg(health_score), 1) FROM vertiflow.basil_ultimate_realtime WHERE timestamp >= now() - INTERVAL 24 HOUR",
          "refId": "A"
        }
      ],
      "title": "üíä Score Sant√© Moyen",
      "type": "stat"
    },
    {
      "datasource": {
        "type": "grafana-clickhouse-datasource",
        "uid": "aeb1b4ee-1f88-42c3-a35a-f594cac90e00"
      },
      "description": "Vue consolid√©e des derni√®res mesures et pr√©dictions par lot de culture.",
      "fieldConfig": {
        "defaults": {
          "custom": {
            "align": "center",
            "cellOptions": {
              "type": "auto"
            },
            "footer": {
              "reducers": []
            },
            "inspect": false
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          }
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Rendement"
            },
            "properties": [
              {
                "id": "unit",
                "value": "kg/m¬≤"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Sante"
            },
            "properties": [
              {
                "id": "unit",
                "value": "percent"
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Anomalie"
            },
            "properties": [
              {
                "id": "custom.cellOptions",
                "value": {
                  "mode": "gradient",
                  "type": "color-background"
                }
              },
              {
                "id": "thresholds",
                "value": {
                  "mode": "absolute",
                  "steps": [
                    {
                      "color": "green",
                      "value": 0
                    },
                    {
                      "color": "red",
                      "value": 0.5
                    }
                  ]
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 8,
        "x": 16,
        "y": 51
      },
      "id": 36,
      "options": {
        "cellHeight": "sm",
        "showHeader": true
      },
      "pluginVersion": "12.3.2",
      "targets": [
        {
          "format": 1,
          "rawSql": "SELECT batch_id as Lot, max(timestamp) as Derniere_MAJ, round(avg(predicted_yield_kg_m2), 2) as Rendement, any(quality_grade_prediction) as Qualite, round(avg(health_score), 0) as Sante, round(avg(anomaly_confidence_score), 2) as Anomalie FROM vertiflow.basil_ultimate_realtime WHERE timestamp >= now() - INTERVAL 24 HOUR GROUP BY batch_id ORDER BY Derniere_MAJ DESC LIMIT 10",
          "refId": "A"
        }
      ],
      "title": "üìã Derni√®res Donn√©es par Lot",
      "type": "table"
    },
    {
      "datasource": {
        "type": "grafana-clickhouse-datasource",
        "uid": "aeb1b4ee-1f88-42c3-a35a-f594cac90e00"
      },
      "description": "Suivi temporel des KPIs: sant√©, anomalies, int√©grit√© et rendement scal√©. Permet de corr√©ler les variations et identifier les causes racines.",
      "fieldConfig": {
        "defaults": {
          "color": {
            "mode": "palette-classic"
          },
          "custom": {
            "axisBorderShow": false,
            "axisCenteredZero": false,
            "axisColorMode": "text",
            "axisLabel": "",
            "axisPlacement": "auto",
            "barAlignment": 0,
            "barWidthFactor": 0.6,
            "drawStyle": "line",
            "fillOpacity": 10,
            "gradientMode": "none",
            "hideFrom": {
              "legend": false,
              "tooltip": false,
              "viz": false
            },
            "insertNulls": false,
            "lineInterpolation": "linear",
            "lineWidth": 2,
            "pointSize": 5,
            "scaleDistribution": {
              "type": "linear"
            },
            "showPoints": "auto",
            "showValues": false,
            "spanNulls": false,
            "stacking": {
              "group": "A",
              "mode": "none"
            },
            "thresholdsStyle": {
              "mode": "off"
            }
          },
          "mappings": [],
          "thresholds": {
            "mode": "absolute",
            "steps": [
              {
                "color": "green",
                "value": 0
              },
              {
                "color": "red",
                "value": 80
              }
            ]
          },
          "unit": "percent"
        },
        "overrides": [
          {
            "matcher": {
              "id": "byName",
              "options": "Sante"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "green",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Anomalie"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "red",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Integrite"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "blue",
                  "mode": "fixed"
                }
              }
            ]
          },
          {
            "matcher": {
              "id": "byName",
              "options": "Rendement_x25"
            },
            "properties": [
              {
                "id": "color",
                "value": {
                  "fixedColor": "purple",
                  "mode": "fixed"
                }
              }
            ]
          }
        ]
      },
      "gridPos": {
        "h": 8,
        "w": 16,
        "x": 0,
        "y": 56
      },
      "id": 35,
      "options": {
        "legend": {
          "calcs": [
            "mean",
            "min",
            "max"
          ],
          "displayMode": "table",
          "placement": "right",
          "showLegend": true
        },
        "tooltip": {
          "hideZeros": false,
          "mode": "single",
          "sort": "none"
        }
      },
      "pluginVersion": "12.3.2",
      "targets": [
        {
          "format": 0,
          "rawSql": "SELECT toStartOfHour(timestamp) as time, round(avg(health_score), 1) as Sante, round(avg(anomaly_confidence_score) * 100, 1) as Anomalie, round(avg(module_integrity_score), 1) as Integrite, round(avg(predicted_yield_kg_m2) * 25, 1) as Rendement_x25 FROM vertiflow.basil_ultimate_realtime WHERE timestamp >= now() - INTERVAL 7 DAY GROUP BY time ORDER BY time",
          "refId": "A"
        }
      ],
      "title": "üìä √âvolution des Indicateurs de Performance",
      "type": "timeseries"
    },
    {
      "collapsed": false,
      "gridPos": {
        "h": 1,
        "w": 24,
        "x": 0,
        "y": 64
      },
      "id": 37,
      "panels": [],
      "title": "üìñ Documentation et R√©f√©rences Scientifiques",
      "type": "row"
    },
    {
      "fieldConfig": {
        "defaults": {},
        "overrides": []
      },
      "gridPos": {
        "h": 6,
        "w": 24,
        "x": 0,
        "y": 65
      },
      "id": 38,
      "options": {
        "code": {
          "language": "plaintext",
          "showLineNumbers": false,
          "showMiniMap": false
        },
        "content": "### R√©f√©rences Scientifiques des Mod√®les VertiFlow\n\n| Mod√®le | M√©thode | R√©f√©rence |\n|--------|---------|----------|\n| **A9 Oracle** | Random Forest | Breiman, L. (2001). Random Forests. *Machine Learning*, 45(1), 5-32. |\n| **A9b Harvest** | Growing Degree Days | McMaster, G.S., & Wilhelm, W.W. (1997). Growing degree-days: one equation, two interpretations. *Agricultural and Forest Meteorology*, 87(4), 291-300. |\n| **A9b Harvest** | Mod√®le Gompertz | Zwietering, M.H., et al. (1990). Modeling of the bacterial growth curve. *Applied and Environmental Microbiology*, 56(6), 1875-1881. |\n| **A9b Harvest** | VPD (Tetens) | Tetens, O. (1930). √úber einige meteorologische Begriffe. *Zeitschrift f√ºr Geophysik*, 6, 297-309. |\n| **A9b Harvest** | DLI Optimal | Faust, J.E., & Logan, J. (2018). Daily Light Integral: A Research Review and High-resolution Maps. *HortScience*, 53(9), 1250-1257. |\n| **A10 Classifier** | Gradient Boosting | Friedman, J.H. (2001). Greedy function approximation: A gradient boosting machine. *Annals of Statistics*, 29(5), 1189-1232. |\n| **A11 Cortex** | L-BFGS-B | Byrd, R.H., et al. (1995). A limited memory algorithm for bound constrained optimization. *SIAM Journal on Scientific Computing*, 16(5), 1190-1208. |\n\n---\n**VertiFlow‚Ñ¢ Data Platform** | Version 2.0 | Derni√®re mise √† jour: 2026-02-05",
        "mode": "markdown"
      },
      "pluginVersion": "12.3.2",
      "title": "üìö R√©f√©rences Bibliographiques",
      "type": "text"
    }
  ],
  "preload": false,
  "refresh": "30s",
  "schemaVersion": 42,
  "tags": [
    "vertiflow",
    "ml",
    "ia",
    "predictions",
    "oracle",
    "harvest",
    "classifier",
    "cortex",
    "gdd",
    "gompertz"
  ],
  "templating": {
    "list": [
      {
        "current": {
          "text": "All",
          "value": "$__all"
        },
        "datasource": {
          "type": "grafana-clickhouse-datasource",
          "uid": "aeb1b4ee-1f88-42c3-a35a-f594cac90e00"
        },
        "includeAll": true,
        "label": "Zone de Culture",
        "multi": true,
        "name": "zone",
        "options": [],
        "query": "SELECT DISTINCT zone FROM vertiflow.harvest_predictions ORDER BY zone",
        "refresh": 2,
        "type": "query"
      },
      {
        "current": {
          "text": "All",
          "value": "$__all"
        },
        "datasource": {
          "type": "grafana-clickhouse-datasource",
          "uid": "aeb1b4ee-1f88-42c3-a35a-f594cac90e00"
        },
        "includeAll": true,
        "label": "Lot de Culture",
        "multi": true,
        "name": "batch_id",
        "options": [],
        "query": "SELECT DISTINCT batch_id FROM vertiflow.basil_ultimate_realtime ORDER BY batch_id",
        "refresh": 2,
        "type": "query"
      }
    ]
  },
  "time": {
    "from": "now-24h",
    "to": "now"
  },
  "timepicker": {
    "refresh_intervals": [
      "5s",
      "10s",
      "30s",
      "1m",
      "5m",
      "15m"
    ]
  },
  "timezone": "browser",
  "title": "08 - Intelligence Artificielle VertiFlow",
  "uid": "vertiflow-ml-predictions-v2",
  "version": 2
}
